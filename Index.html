<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mini App Earner</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src='//libtl.com/sdk.js' data-zone='10337526' data-sdk='show_10337526'></script>
    
    <style>
        :root {
            --primary: #0088cc;
            --bg-color: #f4f4f5;
            --card-bg: #ffffff;
            --text-main: #333333;
            --danger: #ff4757;
            --success: #2ed573;
        }

        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; padding: 0; font-family: 'Hind Siliguri', sans-serif; background: var(--bg-color); color: var(--text-main); user-select: none; }

        /* --- LOGIN SCREEN --- */
        #login-view {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 30px;
            background: linear-gradient(135deg, #e0f7fa 0%, #fff 100%);
        }
        .login-card {
            background: white; width: 100%; max-width: 350px; padding: 30px;
            border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); text-align: center;
        }
        .login-input {
            width: 100%; padding: 15px; margin: 8px 0; border: 1px solid #ddd;
            border-radius: 12px; font-size: 16px; background: #fafafa;
        }
        .checkbox-container {
            display: flex; align-items: center; gap: 10px; margin: 10px 0; font-size: 14px; color: #666; justify-content: flex-start;
        }
        .btn-primary {
            width: 100%; padding: 15px; border: none; border-radius: 12px;
            background: var(--primary); color: white; font-size: 16px; font-weight: bold;
            cursor: pointer; transition: 0.2s; margin-top: 10px;
        }
        .btn-primary:active { transform: scale(0.98); }

        /* --- MAIN APP --- */
        #app-view { display: none; padding-bottom: 80px; } 

        /* Header */
        .header {
            background: var(--primary); color: white; padding: 20px; padding-top: 40px;
            border-bottom-left-radius: 25px; border-bottom-right-radius: 25px;
            box-shadow: 0 5px 15px rgba(0,136,204,0.3);
            display: flex; justify-content: space-between; align-items: center;
        }
        .balance-badge {
            background: rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 20px; font-weight: bold;
        }

        .section { display: none; padding: 20px; animation: fadeIn 0.3s; }
        .section.active { display: block; }
        .card { background: var(--card-bg); padding: 20px; border-radius: 15px; margin-bottom: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); }
        .notice-box { background: #fff3cd; color: #856404; padding: 15px; border-radius: 12px; font-size: 14px; margin-bottom: 20px; border-left: 5px solid #ffc107; }

        .task-btn {
            background: linear-gradient(45deg, #11998e, #38ef7d); color: white;
            padding: 20px; border-radius: 15px; text-align: center; width: 100%; border: none;
            font-size: 18px; font-weight: bold; box-shadow: 0 5px 15px rgba(46, 213, 115, 0.4);
            cursor: pointer; margin-bottom: 15px;
        }
        .task-btn:disabled { background: #ccc; box-shadow: none; cursor: not-allowed; }
        
        .channel-btn {
            background: #229ED9; color: white; width: 100%; padding: 15px; border: none;
            border-radius: 12px; font-weight: bold; margin-top: 10px; display: flex;
            align-items: center; justify-content: center; gap: 10px;
        }

        .stats { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .stat-item { background: white; padding: 15px; border-radius: 12px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        .wallet-balance { font-size: 32px; font-weight: 700; color: var(--primary); text-align: center; margin: 20px 0; }
        
        /* Helper Text Styles */
        .info-text { font-size: 13px; color: #666; margin-bottom: 15px; line-height: 1.6; }
        .rule-list { font-size: 13px; color: #555; padding-left: 20px; margin-bottom: 15px; }
        .rule-list li { margin-bottom: 5px; }

        /* --- BOTTOM NAVIGATION --- */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: #fff; padding: 10px 0;
            display: flex; justify-content: space-around;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.05);
            border-top-left-radius: 20px; border-top-right-radius: 20px;
            z-index: 100;
        }
        .nav-item {
            display: flex; flex-direction: column; align-items: center;
            color: #777; font-size: 12px; cursor: pointer; transition: 0.3s;
        }
        .nav-item i { font-size: 20px; margin-bottom: 4px; }
        .nav-item.active { color: var(--primary); transform: translateY(-2px); }

        /* Loader */
        .loader {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.8); z-index: 200; justify-content: center; align-items: center;
        }
        .spinner {
            border: 4px solid #f3f3f3; border-top: 4px solid var(--primary);
            border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div id="fullLoader" class="loader"><div class="spinner"></div></div>

<div id="login-view">
    <div class="login-card">
        <div style="font-size: 40px; color: var(--primary); margin-bottom: 10px;">
            <i class="fas fa-gift"></i>
        </div>
        <h2>‡¶≤‡¶ó‡¶á‡¶® / ‡¶∏‡¶æ‡¶á‡¶®‡¶Ü‡¶™</h2>
        <p style="color: #666; font-size: 14px;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</p>
        
        <input type="text" id="usernameInput" class="login-input" placeholder="‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ (English, ‡¶õ‡ßã‡¶ü ‡¶π‡¶æ‡¶§‡ßá‡¶∞)">
        <input type="password" id="passwordInput" class="login-input" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®">
        
        <label style="font-size: 12px; color: #777; display: block; text-align: left; margin-top: 5px;">‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° (‡¶Ö‡¶ü‡ßã‡¶Æ‡ßá‡¶ü‡¶ø‡¶ï)</label>
        <input type="text" id="refInput" class="login-input" placeholder="Referral Code" style="background: #eee;" readonly>
        
        <div class="checkbox-container">
            <input type="checkbox" id="rememberMe" style="width: 18px; height: 18px;">
            <label for="rememberMe">Remember Me</label>
        </div>
        
        <button class="btn-primary" onclick="handleAuth()">‡¶è‡¶ó‡¶ø‡ßü‡ßá ‡¶Ø‡¶æ‡¶®</button>
        <p id="loginError" style="color: red; font-size: 12px; display: none; margin-top: 10px;"></p>
    </div>
</div>

<div id="app-view">
    <div class="header">
        <div>
            <span style="font-size: 14px; opacity: 0.9;">‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ,</span><br>
            <strong id="displayUsername" style="font-size: 18px;">User</strong>
        </div>
        <div class="balance-badge">
            ‡ß≥ <span id="headerBalance">0.00</span>
        </div>
    </div>

    <div id="tab-home" class="section active">
        <div id="noticeArea" class="notice-box" style="display: none;">
            <i class="fas fa-bullhorn"></i> <span id="noticeText"></span>
        </div>

        <div class="stats">
            <div class="stat-item">
                <i class="fas fa-eye" style="color: var(--primary); font-size: 24px;"></i>
                <div style="font-size: 20px; font-weight: bold; margin-top: 5px;" id="adsToday">0</div>
                <small>‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ï‡¶æ‡¶ú</small>
            </div>
            <div class="stat-item">
                <i class="fas fa-users" style="color: var(--success); font-size: 24px;"></i>
                <div style="font-size: 20px; font-weight: bold; margin-top: 5px;" id="totalRef">0</div>
                <small>‡¶Æ‡ßã‡¶ü ‡¶∞‡ßá‡¶´‡¶æ‡¶∞</small>
            </div>
        </div>

        <div class="card">
            <h3>‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</h3>
            <p style="font-size: 13px; color: #666;">‡¶∏‡¶ï‡¶≤ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶è‡¶¨‡¶Ç ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶™‡ßá‡¶§‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡ßá ‡¶ú‡ßü‡ßá‡¶® ‡¶•‡¶æ‡¶ï‡ßÅ‡¶®‡•§</p>
            <button class="channel-btn" onclick="joinChannel()">
                <i class="fab fa-telegram-plane"></i> Join Telegram
            </button>
        </div>
    </div>

    <div id="tab-task" class="section">
        <div class="card" style="text-align: center;">
            <h3>‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</h3>
            <p class="info-text">‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶®‡¶æ ‡¶¶‡ßá‡¶ñ‡¶≤‡ßá ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ø‡ßã‡¶ó ‡¶π‡¶¨‡ßá ‡¶®‡¶æ‡•§</p>
            
            <div style="margin: 20px 0;">
                <span style="font-size: 14px; color: #555;">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ï‡¶ø: </span>
                <strong style="color: var(--primary);" id="limitDisplay">0/0</strong>
            </div>
            
            <button id="adBtn" class="task-btn" onclick="watchAd()">
                <i class="fas fa-play-circle"></i> ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
            </button>

            <div style="text-align: left; background: #f9f9f9; padding: 10px; border-radius: 10px; margin-top: 15px;">
                <strong style="font-size: 13px;">‚ö†Ô∏è ‡¶®‡¶ø‡ßü‡¶Æ‡¶æ‡¶¨‡¶≤‡ßÄ:</strong>
                <ul class="rule-list">
                    <li>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶® ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶ï ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®‡•§</li>
                    <li>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ‡•§</li>
                    <li>‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡¶ø‡¶∑‡¶ø‡¶¶‡ßç‡¶ß‡•§</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="tab-wallet" class="section">
        <div class="card">
            <h3 style="text-align: center;">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</h3>
            <div class="wallet-balance">‡ß≥ <span id="walletBalance">0.00</span></div>
            <p style="text-align: center; font-size: 12px; color: #777;">‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞: ‡ß≥ <span id="minWithdraw">50</span></p>

            <p class="info-text" style="text-align: center;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶â‡¶™‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶§ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂, ‡¶®‡¶ó‡¶¶ ‡¶¨‡¶æ ‡¶∞‡¶ï‡ßá‡¶ü‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶§‡ßÅ‡¶≤‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®‡•§</p>

            <select id="withdrawMethod" class="login-input">
                <option value="Bkash">‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ (Bkash)</option>
                <option value="Nagad">‡¶®‡¶ó‡¶¶ (Nagad)</option>
                <option value="Rocket">‡¶∞‡¶ï‡ßá‡¶ü (Rocket)</option>
            </select>
            <input type="number" id="withdrawAmount" class="login-input" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£">
            <input type="text" id="withdrawNumber" class="login-input" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞">
            <button class="btn-primary" style="background: var(--danger);" onclick="submitWithdraw()">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶§‡ßÅ‡¶≤‡ßÅ‡¶®</button>
            
            </div>
    </div>

    <div id="tab-profile" class="section">
        <div class="card">
            <h3>‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</h3>
            <div style="margin-top: 10px;">
                <p><strong>‡¶®‡¶æ‡¶Æ:</strong> <span id="profileName">...</span></p>
                <p><strong>‡¶ú‡ßü‡ßá‡¶®‡¶ø‡¶Ç ‡¶°‡ßá‡¶ü:</strong> <span id="joinDate">...</span></p>
                <p><strong>‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏:</strong> <span id="userStatus" style="color: green;">Active</span></p>
            </div>
            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-top: 20px; border: 1px dashed var(--primary);">
                <small>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï:</small>
                <div style="display: flex; gap: 10px; margin-top: 5px;">
                    <input type="text" id="myRefLink" readonly class="login-input" style="margin: 0; font-size: 12px; color: blue;">
                    <button onclick="copyRef()" style="background: var(--primary); color: white; border: none; border-radius: 8px; padding: 0 15px;">‡¶ï‡¶™‡¶ø</button>
                </div>
                <p style="font-size: 11px; color: #777; margin-top: 5px;">
                    ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï‡ßá ‡¶ú‡ßü‡ßá‡¶® ‡¶ï‡¶∞‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶≤‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡¶æ‡¶¨‡ßá‡¶®‡•§
                </p>
            </div>
            <button onclick="logout()" class="btn-primary" style="background: #333; margin-top: 20px;">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
        </div>
    </div>

</div>

<div id="bottomNav" class="bottom-nav" style="display: none;">
    <div class="nav-item active" onclick="switchTab('home', this)"><i class="fas fa-home"></i><span>‡¶π‡ßã‡¶Æ</span></div>
    <div class="nav-item" onclick="switchTab('task', this)"><i class="fas fa-layer-group"></i><span>‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</span></div>
    <div class="nav-item" onclick="switchTab('wallet', this)"><i class="fas fa-wallet"></i><span>‡¶ì‡ßü‡¶æ‡¶≤‡ßá‡¶ü</span></div>
    <div class="nav-item" onclick="switchTab('profile', this)"><i class="fas fa-user"></i><span>‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</span></div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc, onSnapshot, increment, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // ‚ö†Ô∏è ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ FIREBASE CONFIG (‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§) ‚ö†Ô∏è
    const firebaseConfig = {
      apiKey: "AIzaSyAeYKN-wZlvIy7eezYDno4GXww9p_YLdcA",
      authDomain: "free-income-317de.firebaseapp.com",
      databaseURL: "https://free-income-317de-default-rtdb.firebaseio.com",
      projectId: "free-income-317de",
      storageBucket: "free-income-317de.firebasestorage.app",
      messagingSenderId: "564502996068",
      appId: "1:564502996068:web:1024f6bfaebd64b8546b71"
    };

    // ===============================================
    // üî• ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶® (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶®) üî•
    // ===============================================
    const telegramAppConfig = {
        botUsername: "Free_income653Bot",  // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ü‡ßá‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ (ex: MyBot)
        appName: "FreeIncome"              // BotFather ‡¶è ‡¶¶‡ßá‡¶ì‡ßü‡¶æ App Short Name
    };
    
    let app, db;
    try {
        app = initializeApp(firebaseConfig);
        db = getFirestore(app);
    } catch (e) { console.error("Firebase Error", e); }

    let currentUser = null;
    let appSettings = {};

    window.onload = () => {
        // ‡ßß. ‡¶Ö‡¶ü‡ßã ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° ‡¶ß‡¶∞‡¶æ (Telegram Start Param)
        const tg = window.Telegram.WebApp;
        tg.expand();

        // Telegram ‡¶è‡¶∞ start_param ‡¶•‡ßá‡¶ï‡ßá ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° ‡¶ß‡¶∞‡¶æ
        if(tg.initDataUnsafe && tg.initDataUnsafe.start_param) {
            const refCode = tg.initDataUnsafe.start_param;
            const refInput = document.getElementById("refInput");
            if(refInput) {
                refInput.value = refCode;
                // refInput.readOnly = true; HTML ‡¶è ‡¶è‡¶Æ‡¶®‡¶ø‡¶§‡ßá‡¶á readonly ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶Ü‡¶õ‡ßá
            }
        }

        // ‡¶Ö‡¶ü‡ßã ‡¶≤‡¶ó‡¶á‡¶® ‡¶ö‡ßá‡¶ï
        const localUser = localStorage.getItem("earningAppUser");
        if(localUser) { loginUser(localUser); return; }
        const sessionUser = sessionStorage.getItem("earningAppUser");
        if(sessionUser) { loginUser(sessionUser); }
    };

    // --- AUTH LOGIC (Updated) ---
    window.handleAuth = async () => {
        const username = document.getElementById("usernameInput").value.trim().toLowerCase();
        const password = document.getElementById("passwordInput").value.trim();
        const refCode = document.getElementById("refInput").value.trim();
        const rememberMe = document.getElementById("rememberMe").checked;
        const errorMsg = document.getElementById("loginError");

        // ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶®
        if(username.length < 4 || password.length < 4) {
            errorMsg.innerText = "‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶ì ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶Ö‡¶®‡ßç‡¶§‡¶§ ‡ß™ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞‡ßá‡¶∞ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§";
            errorMsg.style.display = "block";
            return;
        }

        // ‡¶∏‡ßç‡¶™‡ßá‡¶∏ ‡¶¨‡¶æ ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶ï‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ö‡ßá‡¶ï
        if (/[^a-z0-9]/.test(username)) {
            errorMsg.innerText = "‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶õ‡ßã‡¶ü ‡¶π‡¶æ‡¶§‡ßá‡¶∞ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶ì ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶ï‡ßã‡¶® ‡¶∏‡ßç‡¶™‡ßá‡¶∏ ‡¶®‡ßü)‡•§";
            errorMsg.style.display = "block";
            return;
        }

        document.getElementById("fullLoader").style.display = "flex";
        errorMsg.style.display = "none";

        try {
            const userRef = doc(db, "users", username);
            const userSnap = await getDoc(userRef);

            // ‡ßß. ‡¶Ø‡¶¶‡¶ø ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶•‡¶æ‡¶ï‡ßá -> ‡¶≤‡¶ó‡¶á‡¶®
            if (userSnap.exists()) {
                const userData = userSnap.data();
                if (userData.password === password) {
                    if(userData.status === "blocked") {
                        alert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶¨‡ßç‡¶≤‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
                        document.getElementById("fullLoader").style.display = "none";
                        return;
                    }
                    saveSession(username, rememberMe);
                    loginUser(username);
                } else {
                    errorMsg.innerText = "‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°! ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§";
                    errorMsg.style.display = "block";
                    document.getElementById("fullLoader").style.display = "none";
                }
            } 
            // ‡ß®. ‡¶Ø‡¶¶‡¶ø ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá -> ‡¶∏‡¶æ‡¶á‡¶®‡¶Ü‡¶™
            else {
                if(!confirm(`"${username}" ‡¶®‡¶æ‡¶Æ‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶ñ‡ßÅ‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?`)) {
                    document.getElementById("fullLoader").style.display = "none";
                    return;
                }

                // ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶§‡¶•‡ßç‡¶Ø ‡¶®‡ßá‡¶ì‡ßü‡¶æ
                const settingsRef = doc(db, "settings", "config");
                const settingsSnap = await getDoc(settingsRef);
                let signupBonus = 0;
                
                if(settingsSnap.exists()) {
                    const s = settingsSnap.data();
                    signupBonus = s.signup_bonus || 0;
                }

                const todayStr = new Date().toDateString();

                // ‡¶®‡¶§‡ßÅ‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶§‡ßà‡¶∞‡¶ø
                await setDoc(userRef, {
                    username: username,
                    password: password,
                    balance: signupBonus,
                    ads_today: 0,
                    total_ads: 0,
                    total_ref: 0,
                    referred_by: refCode || "none", // ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
                    referral_paid: false, // ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ
                    status: "active",
                    last_ad_date: todayStr, // ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶≤‡¶ú‡¶ø‡¶ï‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£
                    join_date: todayStr,
                    created_at: serverTimestamp()
                });

                // ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶¨‡¶æ‡ßú‡¶æ‡¶®‡ßã (‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶è‡¶ñ‡¶®‡¶á ‡¶®‡¶æ)
                if(refCode && refCode !== username) {
                    const refUserRef = doc(db, "users", refCode);
                    const refUserSnap = await getDoc(refUserRef);
                    if(refUserSnap.exists()) {
                        await updateDoc(refUserRef, {
                            total_ref: increment(1)
                        });
                    }
                }

                alert(`‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ! ‡¶Ü‡¶™‡¶®‡¶ø ${signupBonus} ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶∏‡¶æ‡¶á‡¶®‡¶Ü‡¶™ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®!`);
                saveSession(username, rememberMe);
                loginUser(username);
            }

        } catch (error) {
            console.error(error);
            alert("‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
            document.getElementById("fullLoader").style.display = "none";
        }
    };

    function saveSession(username, remember) {
        if(remember) localStorage.setItem("earningAppUser", username);
        else sessionStorage.setItem("earningAppUser", username);
    }

    function loginUser(username) {
        currentUser = username;
        document.getElementById("login-view").style.display = "none";
        document.getElementById("app-view").style.display = "block";
        document.getElementById("bottomNav").style.display = "flex";
        document.getElementById("fullLoader").style.display = "none";
        
        loadUserData(username);
        loadSettings();
    }

    // --- USER DATA & DAILY RESET LOGIC ---
    function loadUserData(username) {
        const userRef = doc(db, "users", username);

        onSnapshot(userRef, async (docSnap) => {
            if(docSnap.exists()) {
                const data = docSnap.data();

                // üî• DAILY RESET LOGIC üî•
                const todayStr = new Date().toDateString();
                if (data.last_ad_date !== todayStr) {
                    // ‡¶Ø‡¶¶‡¶ø ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶®‡¶æ ‡¶Æ‡¶ø‡¶≤‡ßá, ‡¶§‡¶¨‡ßá ads_today ‡ß¶ ‡¶ï‡¶∞‡ßá ‡¶¶‡¶æ‡¶ì ‡¶è‡¶¨‡¶Ç ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞
                    await updateDoc(userRef, {
                        ads_today: 0,
                        last_ad_date: todayStr
                    });
                    // UI ‡¶§‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶§‡ßá ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶∏‡¶Æ‡ßü ‡¶®‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá, ‡¶§‡¶æ‡¶á Snapshot ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶´‡¶æ‡ßü‡¶æ‡¶∞ ‡¶π‡¶¨‡ßá
                    return; 
                }

                // UI Update
                document.getElementById("displayUsername").innerText = data.username;
                document.getElementById("profileName").innerText = data.username;
                document.getElementById("headerBalance").innerText = data.balance.toFixed(2);
                document.getElementById("walletBalance").innerText = data.balance.toFixed(2);
                document.getElementById("adsToday").innerText = data.ads_today;
                document.getElementById("totalRef").innerText = data.total_ref || 0;
                document.getElementById("joinDate").innerText = data.join_date;
                document.getElementById("userStatus").innerText = data.status === "active" ? "Active" : "Blocked";
                if(data.status === "blocked") document.getElementById("userStatus").style.color = "red";
                
                // üî• Telegram Bot Deep Link ‡¶§‡ßà‡¶∞‡¶ø üî•
                // Link format: https://t.me/BotUsername/AppName?startapp=username
                const link = `https://t.me/${telegramAppConfig.botUsername}/${telegramAppConfig.appName}?startapp=${data.username}`;
                document.getElementById("myRefLink").value = link;
            }
        });
    }

    function loadSettings() {
        onSnapshot(doc(db, "settings", "config"), (docSnap) => {
            if(docSnap.exists()) {
                appSettings = docSnap.data();
                
                // ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶Æ‡¶æ‡¶® ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶¶‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá
                const limit = appSettings.daily_ad_limit || 10;
                const minW = appSettings.min_withdraw || 50;

                const done = parseInt(document.getElementById("adsToday").innerText) || 0;
                document.getElementById("limitDisplay").innerText = `${done}/${limit}`;
                document.getElementById("minWithdraw").innerText = minW;
                
                if(appSettings.notice_text) {
                    document.getElementById("noticeArea").style.display = "block";
                    document.getElementById("noticeText").innerText = appSettings.notice_text;
                }
            }
        });
    }

    // --- AD SYSTEM (Monetag Logic) ---
    window.watchAd = async () => {
        if(!currentUser) return;
        
        // ‡¶¨‡ßç‡¶≤‡¶ï ‡¶ö‡ßá‡¶ï
        const status = document.getElementById("userStatus").innerText;
        if(status === "Blocked") { alert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶¨‡ßç‡¶≤‡¶ï ‡¶Ü‡¶õ‡ßá‡•§"); return; }

        const currentDone = parseInt(document.getElementById("adsToday").innerText);
        const limit = appSettings.daily_ad_limit || 10;
        
        if(currentDone >= limit) { 
            alert("‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶∂‡ßá‡¶∑! ‡¶Ü‡¶ó‡¶æ‡¶Æ‡ßÄ‡¶ï‡¶æ‡¶≤ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§"); 
            return; 
        }

        const btn = document.getElementById("adBtn");
        btn.disabled = true;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...';

        // Monetag Script Check and Call
        if (typeof window.show_10337526 === 'function') {
            window.show_10337526().then(async () => {
                try {
                    const userRef = doc(db, "users", currentUser);
                    
                    // ‡ßß. ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶è‡¶¨‡¶Ç ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
                    await updateDoc(userRef, {
                        balance: increment(appSettings.ad_reward || 0.50),
                        ads_today: increment(1),
                        total_ads: increment(1)
                    });

                    // ‡ß®. ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶≤‡¶ú‡¶ø‡¶ï (‡¶∂‡¶∞‡ßç‡¶§ ‡¶∏‡¶æ‡¶™‡ßá‡¶ï‡ßç‡¶∑‡ßá)
                    const uSnap = await getDoc(userRef);
                    const uData = uSnap.data();
                    
                    const refTarget = appSettings.referral_target || 10; 
                    
                    if (uData.referred_by && uData.referred_by !== "none" && !uData.referral_paid && uData.total_ads >= refTarget) {
                        const referrerRef = doc(db, "users", uData.referred_by);
                        const refSnap = await getDoc(referrerRef);
                        
                        if(refSnap.exists()) {
                             await updateDoc(referrerRef, {
                                 balance: increment(appSettings.referral_bonus || 2.00) 
                             });
                             // ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶á ‡¶Ø‡ßá ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
                             await updateDoc(userRef, { referral_paid: true });
                        }
                    }

                    alert("‡¶Ö‡¶≠‡¶ø‡¶®‡¶®‡ßç‡¶¶‡¶®! ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");

                } catch (e) { 
                    console.error(e); 
                    alert("‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
                }
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-play-circle"></i> ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®';
            }).catch((e) => {
                alert("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶ü‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶π‡ßü‡¶®‡¶ø ‡¶¨‡¶æ ‡¶ï‡ßç‡¶≤‡ßã‡¶ú ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-play-circle"></i> ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®';
            });
        } else {
            alert("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ‡•§ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶™‡ßá‡¶ú ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶¶‡¶ø‡¶®‡•§");
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-play-circle"></i> ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®';
        }
    };

    window.joinChannel = () => {
        if(appSettings.channel_link) window.open(appSettings.channel_link, "_blank");
        else alert("‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶®‡ßá‡¶á");
    };

    window.submitWithdraw = async () => {
        const amount = parseFloat(document.getElementById("withdrawAmount").value);
        const number = document.getElementById("withdrawNumber").value;
        const method = document.getElementById("withdrawMethod").value;
        const currentBal = parseFloat(document.getElementById("walletBalance").innerText);
        const min = appSettings.min_withdraw || 50;
        
        // ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶®
        const status = document.getElementById("userStatus").innerText;
        if(status === "Blocked") { alert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶¨‡ßç‡¶≤‡¶ï ‡¶Ü‡¶õ‡ßá‡•§"); return; }

        if(!amount || !number) return alert("‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶è‡¶¨‡¶Ç ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®‡•§");
        if(amount < min) return alert(`‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ${min} ‡¶ü‡¶æ‡¶ï‡¶æ‡•§`);
        if(amount > currentBal) return alert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶®‡ßá‡¶á!");

        try {
            document.getElementById("fullLoader").style.display = "flex";
            
            // ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶ï‡¶æ‡¶ü‡¶æ
            await updateDoc(doc(db, "users", currentUser), { balance: increment(-amount) });
            
            // ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ
            await addDoc(collection(db, "withdrawals"), {
                user_id: currentUser, 
                amount: amount, 
                method: method, 
                number: number, 
                status: "pending", 
                date: serverTimestamp(),
                date_str: new Date().toLocaleString()
            });
            
            alert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶∏‡¶´‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá‡•§");
            document.getElementById("withdrawAmount").value = "";
            document.getElementById("withdrawNumber").value = "";
        } catch (e) { alert("‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: " + e.message); }
        document.getElementById("fullLoader").style.display = "none";
    };

    window.copyRef = () => {
        const copyText = document.getElementById("myRefLink");
        copyText.select();
        copyText.setSelectionRange(0, 99999); 
        document.execCommand("copy");
        alert("‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
    };

    window.logout = () => {
        if(confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) {
            localStorage.removeItem("earningAppUser");
            sessionStorage.removeItem("earningAppUser");
            location.reload();
        }
    };

    window.switchTab = (tabName, element) => {
        document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
        document.getElementById('tab-' + tabName).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        if(element) element.classList.add('active');
    };
</script>

</body>
</html>
